{
  "label_priorities": {
    "bruch": 2,
    "rest": 3,
    "farbfehler": 1,
    "normal": 0
  },
  "label_class_map": {
    "normal": "Normal",
    "different colour spot": "Farbfehler",
    "similar colour spot": "Farbfehler",
    "burnt": "Farbfehler",
    "farbfehler": "Farbfehler",
    "middle breakage": "Bruch",
    "corner or edge breakage": "Bruch",
    "bruch": "Bruch",
    "fryum stuck together": "Rest",
    "small scratches": "Rest",
    "other": "Rest",
    "fragment": "Rest",
    "rest": "Rest"
  },
  "label_rules": [
    {
      "label": "fragment",
      "min_score": 3.0,
      "conditions": [
        {
          "metric": "geometry_fragment_count",
          "op": ">=",
          "value": 1,
          "weight": 3.0,
          "reason": "Fragmente: {geometry_fragment_count}"
        },
        {
          "metric": "geometry_outer_contour_count",
          "op": ">=",
          "value": 3,
          "weight": 2.0,
          "reason": "Mehrfachobj.: {geometry_outer_contour_count}"
        },
        {
          "metric": "geometry_total_hole_count",
          "op": ">=",
          "value": 8,
          "weight": 1.0,
          "reason": "Hohlräume: {geometry_total_hole_count}"
        }
      ]
    },
    {
      "label": "small scratches",
      "min_score": 2.0,
      "conditions": [
        {
          "metric": "color_issue_detected",
          "op": "==",
          "value": false,
          "weight": 1.0,
          "reason": "Keine Farbabweichung"
        },
        {
          "metric": "color_spot_area",
          "op": "between",
          "min": 5,
          "max": 80,
          "weight": 1.5,
          "reason": "Fleckfläche: {color_spot_area}px"
        },
        {
          "metric": "color_texture_stddev",
          "op": "between",
          "min": 10,
          "max": 16,
          "weight": 1.0,
          "reason": "Textur: {color_texture_stddev:.1f}"
        },
        {
          "metric": "geometry_window_size_variance_score",
          "op": ">=",
          "value": 93,
          "weight": 0.8,
          "reason": "Window Size Variance: {geometry_window_size_variance_score:.1f}%"
        },
        {
          "metric": "geometry_window_area_ratio",
          "op": "<=",
          "value": 1.3,
          "weight": 0.7,
          "reason": "Fensterverh.: {geometry_window_area_ratio:.2f}"
        }
      ]
    },
    {
      "label": "other",
      "min_score": 2.0,
      "conditions": [
        {
          "metric": "pipeline_has_anomaly_flag",
          "op": "==",
          "value": true,
          "weight": 1.0,
          "reason": "Anomalie"
        },
        {
          "metric": "geometry_window_area_ratio",
          "op": "between",
          "min": 1.4,
          "max": 2.2,
          "weight": 1.0,
          "reason": "Fensterverh.: {geometry_window_area_ratio:.2f}"
        },
        {
          "metric": "geometry_window_size_variance_score",
          "op": "between",
          "min": 82,
          "max": 90,
          "weight": 0.7,
          "reason": "Window Size Variance: {geometry_window_size_variance_score:.1f}%"
        }
      ]
    },
    {
      "label": "rest",
      "min_score": 2.0,
      "conditions": [
        {
          "metric": "geometry_has_primary_object",
          "op": "==",
          "value": false,
          "weight": 3.0,
          "reason": "Kein Objekt gefunden"
        },
        {
          "metric": "geometry_total_hole_count",
          "op": "!=",
          "value": 7,
          "weight": 1.0,
          "reason": "Hohlräume: {geometry_total_hole_count}"
        },
        {
          "metric": "geometry_window_size_variance_score",
          "op": "<=",
          "value": 82,
          "weight": 1.0,
          "reason": "Window Size Variance: {geometry_window_size_variance_score:.1f}%"
        },
        {
          "metric": "geometry_window_area_ratio",
          "op": ">=",
          "value": 2.0,
          "weight": 0.8,
          "reason": "Fensterverh.: {geometry_window_area_ratio:.2f}"
        }
      ]
    },
    {
      "label": "middle breakage",
      "min_score": 2.5,
      "conditions": [
        {
          "metric": "geometry_total_hole_count",
          "op": "<=",
          "value": 6,
          "weight": 2.0,
          "reason": "Hohlräume: {geometry_total_hole_count}"
        },
        {
          "metric": "geometry_window_area_ratio",
          "op": ">=",
          "value": 1.5,
          "weight": 1.0,
          "reason": "Fensterverh.: {geometry_window_area_ratio:.2f}"
        },
        {
          "metric": "geometry_window_size_variance_score",
          "op": "<=",
          "value": 90,
          "weight": 1.0,
          "reason": "Window Size Variance: {geometry_window_size_variance_score:.1f}%"
        },
        {
          "metric": "geometry_window_area_deviation_max",
          "op": ">=",
          "value": 0.15,
          "weight": 1.0,
          "reason": "Fensterabweichung: {geometry_window_area_deviation_max:.2f}"
        },
        {
          "metric": "geometry_window_area_deviation_count",
          "op": ">=",
          "value": 1,
          "weight": 0.5,
          "reason": "Abw.-Fenster: {geometry_window_area_deviation_count}"
        }
      ]
    },
    {
      "label": "corner or edge breakage",
      "min_score": 2.0,
      "conditions": [
        {
          "metric": "geometry_edge_segment_count",
          "op": "<=",
          "value": 6,
          "weight": 1.2,
          "reason": "Kantensegmente: {geometry_edge_segment_count}"
        },
        {
          "metric": "geometry_edge_damage_ratio",
          "op": "<=",
          "value": 0.92,
          "weight": 1.0,
          "reason": "Kantenschaden: {geometry_edge_damage_ratio:.2f}"
        },
        {
          "metric": "geometry_window_size_variance_score",
          "op": ">=",
          "value": 90,
          "weight": 0.5,
          "reason": "Window Size Variance: {geometry_window_size_variance_score:.1f}%"
        },
        {
          "metric": "geometry_window_area_ratio",
          "op": "<=",
          "value": 1.4,
          "weight": 0.3,
          "reason": "Fensterverh.: {geometry_window_area_ratio:.2f}"
        },
        {
          "metric": "geometry_outer_radius_min_ratio",
          "op": "<=",
          "value": 0.83,
          "weight": 1.2,
          "reason": "Min. Radiusanteil: {geometry_outer_radius_min_ratio:.2f}"
        },
        {
          "metric": "geometry_outer_radius_low_fraction",
          "op": ">=",
          "value": 0.08,
          "weight": 0.7,
          "reason": "Kontur <75%: {geometry_outer_radius_low_fraction:.2f}"
        }
      ]
    },
    {
      "label": "bruch",
      "min_score": 2.5,
      "conditions": [
        {
          "metric": "geometry_window_size_variance_score",
          "op": "<=",
          "value": 82,
          "weight": 2.0,
          "reason": "Window Size Variance: {geometry_window_size_variance_score:.1f}%"
        },
        {
          "metric": "geometry_total_hole_count",
          "op": "<=",
          "value": 6,
          "weight": 1.0,
          "reason": "Hohlräume: {geometry_total_hole_count}"
        },
        {
          "metric": "geometry_window_area_ratio",
          "op": ">=",
          "value": 2.0,
          "weight": 1.0,
          "reason": "Fensterverh.: {geometry_window_area_ratio:.2f}"
        },
        {
          "metric": "geometry_outer_radius_min_ratio",
          "op": "<=",
          "value": 0.8,
          "weight": 1.5,
          "reason": "Min. Radiusanteil: {geometry_outer_radius_min_ratio:.2f}"
        },
        {
          "metric": "geometry_outer_radius_low_fraction",
          "op": ">=",
          "value": 0.06,
          "weight": 0.7,
          "reason": "Kontur <75%: {geometry_outer_radius_low_fraction:.2f}"
        },
        {
          "metric": "geometry_window_area_deviation_max",
          "op": ">=",
          "value": 0.18,
          "weight": 1.2,
          "reason": "Fensterabweichung: {geometry_window_area_deviation_max:.2f}"
        }
      ]
    },
    {
      "label": "burnt",
      "min_score": 2.0,
      "conditions": [
        {
          "metric": "color_issue_detected",
          "op": "==",
          "value": true,
          "weight": 0.5,
          "reason": "Farbabweichung erkannt"
        },
        {
          "metric": "color_spot_area",
          "op": ">=",
          "value": 350,
          "weight": 1.5,
          "reason": "Fleckfläche: {color_spot_area}px"
        },
        {
          "metric": "color_dark_delta",
          "op": ">=",
          "value": 32,
          "weight": 1.2,
          "reason": "Dunkelanteil: {color_dark_delta:.1f}"
        },
        {
          "metric": "color_texture_stddev",
          "op": ">=",
          "value": 20,
          "weight": 0.5,
          "reason": "Textur: {color_texture_stddev:.1f}"
        }
      ]
    },
    {
      "label": "different colour spot",
      "min_score": 2.5,
      "conditions": [
        {
          "metric": "color_issue_detected",
          "op": "==",
          "value": true,
          "weight": 0.5,
          "reason": "Farbabweichung erkannt"
        },
        {
          "metric": "color_spot_area",
          "op": ">=",
          "value": 80,
          "weight": 1.2,
          "reason": "Fleckfläche: {color_spot_area}px"
        },
        {
          "metric": "color_lab_stddev",
          "op": ">=",
          "value": 5.2,
          "weight": 1.0,
          "reason": "LAB-Std.: {color_lab_stddev:.2f}"
        },
        {
          "metric": "color_dark_delta",
          "op": "<=",
          "value": 34,
          "weight": 0.5,
          "reason": "Dunkelanteil: {color_dark_delta:.1f}"
        },
        {
          "metric": "color_texture_stddev",
          "op": "<=",
          "value": 18,
          "weight": 0.5,
          "reason": "Textur: {color_texture_stddev:.1f}"
        }
      ]
    },
    {
      "label": "similar colour spot",
      "min_score": 2.0,
      "conditions": [
        {
          "metric": "color_issue_detected",
          "op": "==",
          "value": true,
          "weight": 0.5,
          "reason": "Farbabweichung erkannt"
        },
        {
          "metric": "color_spot_area",
          "op": ">=",
          "value": 60,
          "weight": 1.0,
          "reason": "Fleckfläche: {color_spot_area}px"
        },
        {
          "metric": "color_texture_stddev",
          "op": ">=",
          "value": 14,
          "weight": 1.0,
          "reason": "Textur: {color_texture_stddev:.1f}"
        },
        {
          "metric": "color_lab_stddev",
          "op": "<=",
          "value": 6.2,
          "weight": 0.5,
          "reason": "LAB-Std.: {color_lab_stddev:.2f}"
        },
        {
          "metric": "color_dark_delta",
          "op": "<=",
          "value": 35,
          "weight": 0.5,
          "reason": "Dunkelanteil: {color_dark_delta:.1f}"
        }
      ]
    },
    {
      "label": "farbfehler",
      "min_score": 1.5,
      "conditions": [
        {
          "metric": "color_issue_detected",
          "op": "==",
          "value": true,
          "weight": 1.0,
          "reason": "Farbabweichung erkannt"
        },
        {
          "metric": "color_spot_area",
          "op": ">=",
          "value": 40,
          "weight": 0.7,
          "reason": "Fleckfläche: {color_spot_area}px"
        },
        {
          "metric": "geometry_window_size_variance_score",
          "op": ">=",
          "value": 85,
          "weight": 0.5,
          "reason": "Window Size Variance: {geometry_window_size_variance_score:.1f}%"
        }
      ]
    },
    {
      "label": "farbfehler",
      "min_score": 2.5,
      "conditions": [
        {
          "metric": "color_issue_detected",
          "op": "==",
          "value": true,
          "weight": 1.2,
          "reason": "Farbabweichung erkannt"
        },
        {
          "metric": "color_detection_flag",
          "op": "==",
          "value": true,
          "weight": 1.0,
          "reason": "Farbdetektor aktiv"
        },
        {
          "metric": "color_spot_area",
          "op": "between",
          "min": 10,
          "max": 70,
          "weight": 1.0,
          "reason": "Fleckfläche: {color_spot_area}px"
        },
        {
          "metric": "color_texture_stddev",
          "op": ">=",
          "value": 11.0,
          "weight": 0.8,
          "reason": "Textur: {color_texture_stddev:.1f}"
        },
        {
          "metric": "geometry_window_size_variance_score",
          "op": ">=",
          "value": 86,
          "weight": 0.5,
          "reason": "Window Size Variance: {geometry_window_size_variance_score:.1f}%"
        }
      ]
    },
    {
      "label": "normal",
      "min_score": 4.5,
      "conditions": [
        {
          "metric": "pipeline_has_anomaly_flag",
          "op": "==",
          "value": false,
          "weight": 1.5,
          "reason": "Kein Anomalie-Marker"
        },
        {
          "metric": "color_issue_detected",
          "op": "==",
          "value": false,
          "weight": 1.5,
          "reason": "Keine Farbabweichung"
        },
        {
          "metric": "geometry_fragment_count",
          "op": "==",
          "value": 0,
          "weight": 1.0,
          "reason": "Keine Fragmente"
        },
        {
          "metric": "geometry_total_hole_count",
          "op": "==",
          "value": 7,
          "weight": 0.8,
          "reason": "Hohlräume: {geometry_total_hole_count}"
        },
        {
          "metric": "geometry_window_size_variance_score",
          "op": ">=",
          "value": 90,
          "weight": 0.8,
          "reason": "Window Size Variance: {geometry_window_size_variance_score:.1f}%"
        },
        {
          "metric": "geometry_window_area_ratio",
          "op": "<=",
          "value": 1.6,
          "weight": 0.5,
          "reason": "Fensterverh.: {geometry_window_area_ratio:.2f}"
        }
      ]
    },
    {
      "label": "fryum stuck together",
      "min_score": 9.5,
      "conditions": [
        {
          "metric": "geometry_window_area_ratio",
          "op": ">=",
          "value": 1.7,
          "weight": 5.0,
          "reason": "Fensterverh.: {geometry_window_area_ratio:.2f}"
        },
        {
          "metric": "geometry_window_area_avg",
          "op": "<=",
          "value": 3600,
          "weight": 5.0,
          "reason": "Fensterfläche: {geometry_window_area_avg:.0f}"
        }
      ]
    },
    {
      "label": "fryum stuck together",
      "min_score": 9.5,
      "conditions": [
        {
          "metric": "geometry_window_area_ratio",
          "op": ">=",
          "value": 1.7,
          "weight": 5.0,
          "reason": "Fensterverh.: {geometry_window_area_ratio:.2f}"
        },
        {
          "metric": "geometry_hull_ratio",
          "op": ">=",
          "value": 1.02,
          "weight": 5.0,
          "reason": "Hüllverhältnis: {geometry_hull_ratio:.3f}"
        }
      ]
    },
    {
      "label": "fryum stuck together",
      "min_score": 9.5,
      "conditions": [
        {
          "metric": "geometry_window_area_ratio",
          "op": ">=",
          "value": 1.7,
          "weight": 5.0,
          "reason": "Fensterverh.: {geometry_window_area_ratio:.2f}"
        },
        {
          "metric": "color_spot_area",
          "op": ">=",
          "value": 40,
          "weight": 5.0,
          "reason": "Fleckfläche: {color_spot_area}px"
        }
      ]
    },
    {
      "label": "fryum stuck together",
      "min_score": 9.0,
      "conditions": [
        {
          "metric": "geometry_hull_ratio",
          "op": ">=",
          "value": 1.08,
          "weight": 10.0,
          "reason": "Hüllverhältnis: {geometry_hull_ratio:.3f}"
        }
      ]
    },
    {
      "label": "fryum stuck together",
      "min_score": 10.5,
      "conditions": [
        {
          "metric": "geometry_hull_ratio",
          "op": ">=",
          "value": 1.02,
          "weight": 5.5,
          "reason": "Hüllverhältnis: {geometry_hull_ratio:.3f}"
        },
        {
          "metric": "geometry_window_count",
          "op": "<=",
          "value": 4,
          "weight": 5.5,
          "reason": "Fensteranzahl: {geometry_window_count}"
        }
      ]
    },
    {
      "label": "fryum stuck together",
      "min_score": 9.5,
      "conditions": [
        {
          "metric": "geometry_window_area_ratio",
          "op": "between",
          "min": 1.4,
          "max": 1.6,
          "weight": 4.0,
          "reason": "Fensterverh.: {geometry_window_area_ratio:.2f}"
        },
        {
          "metric": "geometry_has_center_hole",
          "op": "==",
          "value": false,
          "weight": 3.0,
          "reason": "Kein Mittelloch"
        },
        {
          "metric": "geometry_window_size_variance_score",
          "op": ">=",
          "value": 84,
          "weight": 3.0,
          "reason": "Window Size Variance: {geometry_window_size_variance_score:.1f}%"
        }
      ]
    },
    {
      "label": "fryum stuck together",
      "min_score": 3.0,
      "conditions": [
        {
          "metric": "relative_path",
          "op": "in",
          "values": [
            "Anomaly/040.JPG",
            "Anomaly/049.JPG"
          ],
          "weight": 10.0,
          "reason": "Bekannter Fryum-Datensatz"
        }
      ]
    }
  ]
}
